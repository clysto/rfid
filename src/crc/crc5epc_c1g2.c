#include "crc5epc_c1g2.h"

uint8_t crc5epc_c1g2_bit(uint8_t crc, void const *mem, size_t len) {
    unsigned char const *data = mem;
    if (data == NULL)
        return 0x9;
    crc <<= 3;
    for (size_t i = 0; i < len; i++) {
        crc ^= data[i];
        for (unsigned k = 0; k < 8; k++) {
            crc = crc & 0x80 ? (crc << 1) ^ 0x48 : crc << 1;
        }
    }
    crc >>= 3;
    return crc;
}

uint8_t crc5epc_c1g2_rem(uint8_t crc, unsigned val, unsigned bits) {
    crc <<= 3;
    val &= 0x100 - (0x100 >> bits);
    crc ^= val;
    for (unsigned i = 0; i < bits; i++) {
        crc = crc & 0x80 ? (crc << 1) ^ 0x48 : crc << 1;
    }
    crc >>= 3;
    return crc;
}

#define table_byte table_word[0]

static uint8_t const table_word[][256] = {
   {0x00, 0x48, 0x90, 0xd8, 0x68, 0x20, 0xf8, 0xb0, 0xd0, 0x98, 0x40, 0x08, 0xb8,
    0xf0, 0x28, 0x60, 0xe8, 0xa0, 0x78, 0x30, 0x80, 0xc8, 0x10, 0x58, 0x38, 0x70,
    0xa8, 0xe0, 0x50, 0x18, 0xc0, 0x88, 0x98, 0xd0, 0x08, 0x40, 0xf0, 0xb8, 0x60,
    0x28, 0x48, 0x00, 0xd8, 0x90, 0x20, 0x68, 0xb0, 0xf8, 0x70, 0x38, 0xe0, 0xa8,
    0x18, 0x50, 0x88, 0xc0, 0xa0, 0xe8, 0x30, 0x78, 0xc8, 0x80, 0x58, 0x10, 0x78,
    0x30, 0xe8, 0xa0, 0x10, 0x58, 0x80, 0xc8, 0xa8, 0xe0, 0x38, 0x70, 0xc0, 0x88,
    0x50, 0x18, 0x90, 0xd8, 0x00, 0x48, 0xf8, 0xb0, 0x68, 0x20, 0x40, 0x08, 0xd0,
    0x98, 0x28, 0x60, 0xb8, 0xf0, 0xe0, 0xa8, 0x70, 0x38, 0x88, 0xc0, 0x18, 0x50,
    0x30, 0x78, 0xa0, 0xe8, 0x58, 0x10, 0xc8, 0x80, 0x08, 0x40, 0x98, 0xd0, 0x60,
    0x28, 0xf0, 0xb8, 0xd8, 0x90, 0x48, 0x00, 0xb0, 0xf8, 0x20, 0x68, 0xf0, 0xb8,
    0x60, 0x28, 0x98, 0xd0, 0x08, 0x40, 0x20, 0x68, 0xb0, 0xf8, 0x48, 0x00, 0xd8,
    0x90, 0x18, 0x50, 0x88, 0xc0, 0x70, 0x38, 0xe0, 0xa8, 0xc8, 0x80, 0x58, 0x10,
    0xa0, 0xe8, 0x30, 0x78, 0x68, 0x20, 0xf8, 0xb0, 0x00, 0x48, 0x90, 0xd8, 0xb8,
    0xf0, 0x28, 0x60, 0xd0, 0x98, 0x40, 0x08, 0x80, 0xc8, 0x10, 0x58, 0xe8, 0xa0,
    0x78, 0x30, 0x50, 0x18, 0xc0, 0x88, 0x38, 0x70, 0xa8, 0xe0, 0x88, 0xc0, 0x18,
    0x50, 0xe0, 0xa8, 0x70, 0x38, 0x58, 0x10, 0xc8, 0x80, 0x30, 0x78, 0xa0, 0xe8,
    0x60, 0x28, 0xf0, 0xb8, 0x08, 0x40, 0x98, 0xd0, 0xb0, 0xf8, 0x20, 0x68, 0xd8,
    0x90, 0x48, 0x00, 0x10, 0x58, 0x80, 0xc8, 0x78, 0x30, 0xe8, 0xa0, 0xc0, 0x88,
    0x50, 0x18, 0xa8, 0xe0, 0x38, 0x70, 0xf8, 0xb0, 0x68, 0x20, 0x90, 0xd8, 0x00,
    0x48, 0x28, 0x60, 0xb8, 0xf0, 0x40, 0x08, 0xd0, 0x98},
   {0x00, 0xa8, 0x18, 0xb0, 0x30, 0x98, 0x28, 0x80, 0x60, 0xc8, 0x78, 0xd0, 0x50,
    0xf8, 0x48, 0xe0, 0xc0, 0x68, 0xd8, 0x70, 0xf0, 0x58, 0xe8, 0x40, 0xa0, 0x08,
    0xb8, 0x10, 0x90, 0x38, 0x88, 0x20, 0xc8, 0x60, 0xd0, 0x78, 0xf8, 0x50, 0xe0,
    0x48, 0xa8, 0x00, 0xb0, 0x18, 0x98, 0x30, 0x80, 0x28, 0x08, 0xa0, 0x10, 0xb8,
    0x38, 0x90, 0x20, 0x88, 0x68, 0xc0, 0x70, 0xd8, 0x58, 0xf0, 0x40, 0xe8, 0xd8,
    0x70, 0xc0, 0x68, 0xe8, 0x40, 0xf0, 0x58, 0xb8, 0x10, 0xa0, 0x08, 0x88, 0x20,
    0x90, 0x38, 0x18, 0xb0, 0x00, 0xa8, 0x28, 0x80, 0x30, 0x98, 0x78, 0xd0, 0x60,
    0xc8, 0x48, 0xe0, 0x50, 0xf8, 0x10, 0xb8, 0x08, 0xa0, 0x20, 0x88, 0x38, 0x90,
    0x70, 0xd8, 0x68, 0xc0, 0x40, 0xe8, 0x58, 0xf0, 0xd0, 0x78, 0xc8, 0x60, 0xe0,
    0x48, 0xf8, 0x50, 0xb0, 0x18, 0xa8, 0x00, 0x80, 0x28, 0x98, 0x30, 0xf8, 0x50,
    0xe0, 0x48, 0xc8, 0x60, 0xd0, 0x78, 0x98, 0x30, 0x80, 0x28, 0xa8, 0x00, 0xb0,
    0x18, 0x38, 0x90, 0x20, 0x88, 0x08, 0xa0, 0x10, 0xb8, 0x58, 0xf0, 0x40, 0xe8,
    0x68, 0xc0, 0x70, 0xd8, 0x30, 0x98, 0x28, 0x80, 0x00, 0xa8, 0x18, 0xb0, 0x50,
    0xf8, 0x48, 0xe0, 0x60, 0xc8, 0x78, 0xd0, 0xf0, 0x58, 0xe8, 0x40, 0xc0, 0x68,
    0xd8, 0x70, 0x90, 0x38, 0x88, 0x20, 0xa0, 0x08, 0xb8, 0x10, 0x20, 0x88, 0x38,
    0x90, 0x10, 0xb8, 0x08, 0xa0, 0x40, 0xe8, 0x58, 0xf0, 0x70, 0xd8, 0x68, 0xc0,
    0xe0, 0x48, 0xf8, 0x50, 0xd0, 0x78, 0xc8, 0x60, 0x80, 0x28, 0x98, 0x30, 0xb0,
    0x18, 0xa8, 0x00, 0xe8, 0x40, 0xf0, 0x58, 0xd8, 0x70, 0xc0, 0x68, 0x88, 0x20,
    0x90, 0x38, 0xb8, 0x10, 0xa0, 0x08, 0x28, 0x80, 0x30, 0x98, 0x18, 0xb0, 0x00,
    0xa8, 0x48, 0xe0, 0x50, 0xf8, 0x78, 0xd0, 0x60, 0xc8},
   {0x00, 0xb8, 0x38, 0x80, 0x70, 0xc8, 0x48, 0xf0, 0xe0, 0x58, 0xd8, 0x60, 0x90,
    0x28, 0xa8, 0x10, 0x88, 0x30, 0xb0, 0x08, 0xf8, 0x40, 0xc0, 0x78, 0x68, 0xd0,
    0x50, 0xe8, 0x18, 0xa0, 0x20, 0x98, 0x58, 0xe0, 0x60, 0xd8, 0x28, 0x90, 0x10,
    0xa8, 0xb8, 0x00, 0x80, 0x38, 0xc8, 0x70, 0xf0, 0x48, 0xd0, 0x68, 0xe8, 0x50,
    0xa0, 0x18, 0x98, 0x20, 0x30, 0x88, 0x08, 0xb0, 0x40, 0xf8, 0x78, 0xc0, 0xb0,
    0x08, 0x88, 0x30, 0xc0, 0x78, 0xf8, 0x40, 0x50, 0xe8, 0x68, 0xd0, 0x20, 0x98,
    0x18, 0xa0, 0x38, 0x80, 0x00, 0xb8, 0x48, 0xf0, 0x70, 0xc8, 0xd8, 0x60, 0xe0,
    0x58, 0xa8, 0x10, 0x90, 0x28, 0xe8, 0x50, 0xd0, 0x68, 0x98, 0x20, 0xa0, 0x18,
    0x08, 0xb0, 0x30, 0x88, 0x78, 0xc0, 0x40, 0xf8, 0x60, 0xd8, 0x58, 0xe0, 0x10,
    0xa8, 0x28, 0x90, 0x80, 0x38, 0xb8, 0x00, 0xf0, 0x48, 0xc8, 0x70, 0x28, 0x90,
    0x10, 0xa8, 0x58, 0xe0, 0x60, 0xd8, 0xc8, 0x70, 0xf0, 0x48, 0xb8, 0x00, 0x80,
    0x38, 0xa0, 0x18, 0x98, 0x20, 0xd0, 0x68, 0xe8, 0x50, 0x40, 0xf8, 0x78, 0xc0,
    0x30, 0x88, 0x08, 0xb0, 0x70, 0xc8, 0x48, 0xf0, 0x00, 0xb8, 0x38, 0x80, 0x90,
    0x28, 0xa8, 0x10, 0xe0, 0x58, 0xd8, 0x60, 0xf8, 0x40, 0xc0, 0x78, 0x88, 0x30,
    0xb0, 0x08, 0x18, 0xa0, 0x20, 0x98, 0x68, 0xd0, 0x50, 0xe8, 0x98, 0x20, 0xa0,
    0x18, 0xe8, 0x50, 0xd0, 0x68, 0x78, 0xc0, 0x40, 0xf8, 0x08, 0xb0, 0x30, 0x88,
    0x10, 0xa8, 0x28, 0x90, 0x60, 0xd8, 0x58, 0xe0, 0xf0, 0x48, 0xc8, 0x70, 0x80,
    0x38, 0xb8, 0x00, 0xc0, 0x78, 0xf8, 0x40, 0xb0, 0x08, 0x88, 0x30, 0x20, 0x98,
    0x18, 0xa0, 0x50, 0xe8, 0x68, 0xd0, 0x48, 0xf0, 0x70, 0xc8, 0x38, 0x80, 0x00,
    0xb8, 0xa8, 0x10, 0x90, 0x28, 0xd8, 0x60, 0xe0, 0x58},
   {0x00, 0x50, 0xa0, 0xf0, 0x08, 0x58, 0xa8, 0xf8, 0x10, 0x40, 0xb0, 0xe0, 0x18,
    0x48, 0xb8, 0xe8, 0x20, 0x70, 0x80, 0xd0, 0x28, 0x78, 0x88, 0xd8, 0x30, 0x60,
    0x90, 0xc0, 0x38, 0x68, 0x98, 0xc8, 0x40, 0x10, 0xe0, 0xb0, 0x48, 0x18, 0xe8,
    0xb8, 0x50, 0x00, 0xf0, 0xa0, 0x58, 0x08, 0xf8, 0xa8, 0x60, 0x30, 0xc0, 0x90,
    0x68, 0x38, 0xc8, 0x98, 0x70, 0x20, 0xd0, 0x80, 0x78, 0x28, 0xd8, 0x88, 0x80,
    0xd0, 0x20, 0x70, 0x88, 0xd8, 0x28, 0x78, 0x90, 0xc0, 0x30, 0x60, 0x98, 0xc8,
    0x38, 0x68, 0xa0, 0xf0, 0x00, 0x50, 0xa8, 0xf8, 0x08, 0x58, 0xb0, 0xe0, 0x10,
    0x40, 0xb8, 0xe8, 0x18, 0x48, 0xc0, 0x90, 0x60, 0x30, 0xc8, 0x98, 0x68, 0x38,
    0xd0, 0x80, 0x70, 0x20, 0xd8, 0x88, 0x78, 0x28, 0xe0, 0xb0, 0x40, 0x10, 0xe8,
    0xb8, 0x48, 0x18, 0xf0, 0xa0, 0x50, 0x00, 0xf8, 0xa8, 0x58, 0x08, 0x48, 0x18,
    0xe8, 0xb8, 0x40, 0x10, 0xe0, 0xb0, 0x58, 0x08, 0xf8, 0xa8, 0x50, 0x00, 0xf0,
    0xa0, 0x68, 0x38, 0xc8, 0x98, 0x60, 0x30, 0xc0, 0x90, 0x78, 0x28, 0xd8, 0x88,
    0x70, 0x20, 0xd0, 0x80, 0x08, 0x58, 0xa8, 0xf8, 0x00, 0x50, 0xa0, 0xf0, 0x18,
    0x48, 0xb8, 0xe8, 0x10, 0x40, 0xb0, 0xe0, 0x28, 0x78, 0x88, 0xd8, 0x20, 0x70,
    0x80, 0xd0, 0x38, 0x68, 0x98, 0xc8, 0x30, 0x60, 0x90, 0xc0, 0xc8, 0x98, 0x68,
    0x38, 0xc0, 0x90, 0x60, 0x30, 0xd8, 0x88, 0x78, 0x28, 0xd0, 0x80, 0x70, 0x20,
    0xe8, 0xb8, 0x48, 0x18, 0xe0, 0xb0, 0x40, 0x10, 0xf8, 0xa8, 0x58, 0x08, 0xf0,
    0xa0, 0x50, 0x00, 0x88, 0xd8, 0x28, 0x78, 0x80, 0xd0, 0x20, 0x70, 0x98, 0xc8,
    0x38, 0x68, 0x90, 0xc0, 0x30, 0x60, 0xa8, 0xf8, 0x08, 0x58, 0xa0, 0xf0, 0x00,
    0x50, 0xb8, 0xe8, 0x18, 0x48, 0xb0, 0xe0, 0x10, 0x40},
   {0x00, 0x90, 0x68, 0xf8, 0xd0, 0x40, 0xb8, 0x28, 0xe8, 0x78, 0x80, 0x10, 0x38,
    0xa8, 0x50, 0xc0, 0x98, 0x08, 0xf0, 0x60, 0x48, 0xd8, 0x20, 0xb0, 0x70, 0xe0,
    0x18, 0x88, 0xa0, 0x30, 0xc8, 0x58, 0x78, 0xe8, 0x10, 0x80, 0xa8, 0x38, 0xc0,
    0x50, 0x90, 0x00, 0xf8, 0x68, 0x40, 0xd0, 0x28, 0xb8, 0xe0, 0x70, 0x88, 0x18,
    0x30, 0xa0, 0x58, 0xc8, 0x08, 0x98, 0x60, 0xf0, 0xd8, 0x48, 0xb0, 0x20, 0xf0,
    0x60, 0x98, 0x08, 0x20, 0xb0, 0x48, 0xd8, 0x18, 0x88, 0x70, 0xe0, 0xc8, 0x58,
    0xa0, 0x30, 0x68, 0xf8, 0x00, 0x90, 0xb8, 0x28, 0xd0, 0x40, 0x80, 0x10, 0xe8,
    0x78, 0x50, 0xc0, 0x38, 0xa8, 0x88, 0x18, 0xe0, 0x70, 0x58, 0xc8, 0x30, 0xa0,
    0x60, 0xf0, 0x08, 0x98, 0xb0, 0x20, 0xd8, 0x48, 0x10, 0x80, 0x78, 0xe8, 0xc0,
    0x50, 0xa8, 0x38, 0xf8, 0x68, 0x90, 0x00, 0x28, 0xb8, 0x40, 0xd0, 0xa8, 0x38,
    0xc0, 0x50, 0x78, 0xe8, 0x10, 0x80, 0x40, 0xd0, 0x28, 0xb8, 0x90, 0x00, 0xf8,
    0x68, 0x30, 0xa0, 0x58, 0xc8, 0xe0, 0x70, 0x88, 0x18, 0xd8, 0x48, 0xb0, 0x20,
    0x08, 0x98, 0x60, 0xf0, 0xd0, 0x40, 0xb8, 0x28, 0x00, 0x90, 0x68, 0xf8, 0x38,
    0xa8, 0x50, 0xc0, 0xe8, 0x78, 0x80, 0x10, 0x48, 0xd8, 0x20, 0xb0, 0x98, 0x08,
    0xf0, 0x60, 0xa0, 0x30, 0xc8, 0x58, 0x70, 0xe0, 0x18, 0x88, 0x58, 0xc8, 0x30,
    0xa0, 0x88, 0x18, 0xe0, 0x70, 0xb0, 0x20, 0xd8, 0x48, 0x60, 0xf0, 0x08, 0x98,
    0xc0, 0x50, 0xa8, 0x38, 0x10, 0x80, 0x78, 0xe8, 0x28, 0xb8, 0x40, 0xd0, 0xf8,
    0x68, 0x90, 0x00, 0x20, 0xb0, 0x48, 0xd8, 0xf0, 0x60, 0x98, 0x08, 0xc8, 0x58,
    0xa0, 0x30, 0x18, 0x88, 0x70, 0xe0, 0xb8, 0x28, 0xd0, 0x40, 0x68, 0xf8, 0x00,
    0x90, 0x50, 0xc0, 0x38, 0xa8, 0x80, 0x10, 0xe8, 0x78},
   {0x00, 0x18, 0x30, 0x28, 0x60, 0x78, 0x50, 0x48, 0xc0, 0xd8, 0xf0, 0xe8, 0xa0,
    0xb8, 0x90, 0x88, 0xc8, 0xd0, 0xf8, 0xe0, 0xa8, 0xb0, 0x98, 0x80, 0x08, 0x10,
    0x38, 0x20, 0x68, 0x70, 0x58, 0x40, 0xd8, 0xc0, 0xe8, 0xf0, 0xb8, 0xa0, 0x88,
    0x90, 0x18, 0x00, 0x28, 0x30, 0x78, 0x60, 0x48, 0x50, 0x10, 0x08, 0x20, 0x38,
    0x70, 0x68, 0x40, 0x58, 0xd0, 0xc8, 0xe0, 0xf8, 0xb0, 0xa8, 0x80, 0x98, 0xf8,
    0xe0, 0xc8, 0xd0, 0x98, 0x80, 0xa8, 0xb0, 0x38, 0x20, 0x08, 0x10, 0x58, 0x40,
    0x68, 0x70, 0x30, 0x28, 0x00, 0x18, 0x50, 0x48, 0x60, 0x78, 0xf0, 0xe8, 0xc0,
    0xd8, 0x90, 0x88, 0xa0, 0xb8, 0x20, 0x38, 0x10, 0x08, 0x40, 0x58, 0x70, 0x68,
    0xe0, 0xf8, 0xd0, 0xc8, 0x80, 0x98, 0xb0, 0xa8, 0xe8, 0xf0, 0xd8, 0xc0, 0x88,
    0x90, 0xb8, 0xa0, 0x28, 0x30, 0x18, 0x00, 0x48, 0x50, 0x78, 0x60, 0xb8, 0xa0,
    0x88, 0x90, 0xd8, 0xc0, 0xe8, 0xf0, 0x78, 0x60, 0x48, 0x50, 0x18, 0x00, 0x28,
    0x30, 0x70, 0x68, 0x40, 0x58, 0x10, 0x08, 0x20, 0x38, 0xb0, 0xa8, 0x80, 0x98,
    0xd0, 0xc8, 0xe0, 0xf8, 0x60, 0x78, 0x50, 0x48, 0x00, 0x18, 0x30, 0x28, 0xa0,
    0xb8, 0x90, 0x88, 0xc0, 0xd8, 0xf0, 0xe8, 0xa8, 0xb0, 0x98, 0x80, 0xc8, 0xd0,
    0xf8, 0xe0, 0x68, 0x70, 0x58, 0x40, 0x08, 0x10, 0x38, 0x20, 0x40, 0x58, 0x70,
    0x68, 0x20, 0x38, 0x10, 0x08, 0x80, 0x98, 0xb0, 0xa8, 0xe0, 0xf8, 0xd0, 0xc8,
    0x88, 0x90, 0xb8, 0xa0, 0xe8, 0xf0, 0xd8, 0xc0, 0x48, 0x50, 0x78, 0x60, 0x28,
    0x30, 0x18, 0x00, 0x98, 0x80, 0xa8, 0xb0, 0xf8, 0xe0, 0xc8, 0xd0, 0x58, 0x40,
    0x68, 0x70, 0x38, 0x20, 0x08, 0x10, 0x50, 0x48, 0x60, 0x78, 0x30, 0x28, 0x00,
    0x18, 0x90, 0x88, 0xa0, 0xb8, 0xf0, 0xe8, 0xc0, 0xd8},
   {0x00, 0x38, 0x70, 0x48, 0xe0, 0xd8, 0x90, 0xa8, 0x88, 0xb0, 0xf8, 0xc0, 0x68,
    0x50, 0x18, 0x20, 0x58, 0x60, 0x28, 0x10, 0xb8, 0x80, 0xc8, 0xf0, 0xd0, 0xe8,
    0xa0, 0x98, 0x30, 0x08, 0x40, 0x78, 0xb0, 0x88, 0xc0, 0xf8, 0x50, 0x68, 0x20,
    0x18, 0x38, 0x00, 0x48, 0x70, 0xd8, 0xe0, 0xa8, 0x90, 0xe8, 0xd0, 0x98, 0xa0,
    0x08, 0x30, 0x78, 0x40, 0x60, 0x58, 0x10, 0x28, 0x80, 0xb8, 0xf0, 0xc8, 0x28,
    0x10, 0x58, 0x60, 0xc8, 0xf0, 0xb8, 0x80, 0xa0, 0x98, 0xd0, 0xe8, 0x40, 0x78,
    0x30, 0x08, 0x70, 0x48, 0x00, 0x38, 0x90, 0xa8, 0xe0, 0xd8, 0xf8, 0xc0, 0x88,
    0xb0, 0x18, 0x20, 0x68, 0x50, 0x98, 0xa0, 0xe8, 0xd0, 0x78, 0x40, 0x08, 0x30,
    0x10, 0x28, 0x60, 0x58, 0xf0, 0xc8, 0x80, 0xb8, 0xc0, 0xf8, 0xb0, 0x88, 0x20,
    0x18, 0x50, 0x68, 0x48, 0x70, 0x38, 0x00, 0xa8, 0x90, 0xd8, 0xe0, 0x50, 0x68,
    0x20, 0x18, 0xb0, 0x88, 0xc0, 0xf8, 0xd8, 0xe0, 0xa8, 0x90, 0x38, 0x00, 0x48,
    0x70, 0x08, 0x30, 0x78, 0x40, 0xe8, 0xd0, 0x98, 0xa0, 0x80, 0xb8, 0xf0, 0xc8,
    0x60, 0x58, 0x10, 0x28, 0xe0, 0xd8, 0x90, 0xa8, 0x00, 0x38, 0x70, 0x48, 0x68,
    0x50, 0x18, 0x20, 0x88, 0xb0, 0xf8, 0xc0, 0xb8, 0x80, 0xc8, 0xf0, 0x58, 0x60,
    0x28, 0x10, 0x30, 0x08, 0x40, 0x78, 0xd0, 0xe8, 0xa0, 0x98, 0x78, 0x40, 0x08,
    0x30, 0x98, 0xa0, 0xe8, 0xd0, 0xf0, 0xc8, 0x80, 0xb8, 0x10, 0x28, 0x60, 0x58,
    0x20, 0x18, 0x50, 0x68, 0xc0, 0xf8, 0xb0, 0x88, 0xa8, 0x90, 0xd8, 0xe0, 0x48,
    0x70, 0x38, 0x00, 0xc8, 0xf0, 0xb8, 0x80, 0x28, 0x10, 0x58, 0x60, 0x40, 0x78,
    0x30, 0x08, 0xa0, 0x98, 0xd0, 0xe8, 0x90, 0xa8, 0xe0, 0xd8, 0x70, 0x48, 0x00,
    0x38, 0x18, 0x20, 0x68, 0x50, 0xf8, 0xc0, 0x88, 0xb0},
   {0x00, 0xa0, 0x08, 0xa8, 0x10, 0xb0, 0x18, 0xb8, 0x20, 0x80, 0x28, 0x88, 0x30,
    0x90, 0x38, 0x98, 0x40, 0xe0, 0x48, 0xe8, 0x50, 0xf0, 0x58, 0xf8, 0x60, 0xc0,
    0x68, 0xc8, 0x70, 0xd0, 0x78, 0xd8, 0x80, 0x20, 0x88, 0x28, 0x90, 0x30, 0x98,
    0x38, 0xa0, 0x00, 0xa8, 0x08, 0xb0, 0x10, 0xb8, 0x18, 0xc0, 0x60, 0xc8, 0x68,
    0xd0, 0x70, 0xd8, 0x78, 0xe0, 0x40, 0xe8, 0x48, 0xf0, 0x50, 0xf8, 0x58, 0x48,
    0xe8, 0x40, 0xe0, 0x58, 0xf8, 0x50, 0xf0, 0x68, 0xc8, 0x60, 0xc0, 0x78, 0xd8,
    0x70, 0xd0, 0x08, 0xa8, 0x00, 0xa0, 0x18, 0xb8, 0x10, 0xb0, 0x28, 0x88, 0x20,
    0x80, 0x38, 0x98, 0x30, 0x90, 0xc8, 0x68, 0xc0, 0x60, 0xd8, 0x78, 0xd0, 0x70,
    0xe8, 0x48, 0xe0, 0x40, 0xf8, 0x58, 0xf0, 0x50, 0x88, 0x28, 0x80, 0x20, 0x98,
    0x38, 0x90, 0x30, 0xa8, 0x08, 0xa0, 0x00, 0xb8, 0x18, 0xb0, 0x10, 0x90, 0x30,
    0x98, 0x38, 0x80, 0x20, 0x88, 0x28, 0xb0, 0x10, 0xb8, 0x18, 0xa0, 0x00, 0xa8,
    0x08, 0xd0, 0x70, 0xd8, 0x78, 0xc0, 0x60, 0xc8, 0x68, 0xf0, 0x50, 0xf8, 0x58,
    0xe0, 0x40, 0xe8, 0x48, 0x10, 0xb0, 0x18, 0xb8, 0x00, 0xa0, 0x08, 0xa8, 0x30,
    0x90, 0x38, 0x98, 0x20, 0x80, 0x28, 0x88, 0x50, 0xf0, 0x58, 0xf8, 0x40, 0xe0,
    0x48, 0xe8, 0x70, 0xd0, 0x78, 0xd8, 0x60, 0xc0, 0x68, 0xc8, 0xd8, 0x78, 0xd0,
    0x70, 0xc8, 0x68, 0xc0, 0x60, 0xf8, 0x58, 0xf0, 0x50, 0xe8, 0x48, 0xe0, 0x40,
    0x98, 0x38, 0x90, 0x30, 0x88, 0x28, 0x80, 0x20, 0xb8, 0x18, 0xb0, 0x10, 0xa8,
    0x08, 0xa0, 0x00, 0x58, 0xf8, 0x50, 0xf0, 0x48, 0xe8, 0x40, 0xe0, 0x78, 0xd8,
    0x70, 0xd0, 0x68, 0xc8, 0x60, 0xc0, 0x18, 0xb8, 0x10, 0xb0, 0x08, 0xa8, 0x00,
    0xa0, 0x38, 0x98, 0x30, 0x90, 0x28, 0x88, 0x20, 0x80}
};

uint8_t crc5epc_c1g2_byte(uint8_t crc, void const *mem, size_t len) {
    unsigned char const *data = mem;
    if (data == NULL)
        return 0x9;
    crc <<= 3;
    for (size_t i = 0; i < len; i++) {
        crc = table_byte[crc ^ data[i]];
    }
    crc >>= 3;
    return crc;
}

// This code assumes that integers are stored little-endian.

uint8_t crc5epc_c1g2_word(uint8_t crc, void const *mem, size_t len) {
    unsigned char const *data = mem;
    if (data == NULL)
        return 0x9;
    crc <<= 3;
    while (len && ((ptrdiff_t)data & 0x7)) {
        len--;
        crc = table_byte[crc ^ *data++];
    }
    size_t n = len >> 3;
    for (size_t i = 0; i < n; i++) {
        uint64_t word = crc ^ ((uint64_t const *)data)[i];
        crc = table_word[7][word & 0xff] ^
              table_word[6][(word >> 8) & 0xff] ^
              table_word[5][(word >> 16) & 0xff] ^
              table_word[4][(word >> 24) & 0xff] ^
              table_word[3][(word >> 32) & 0xff] ^
              table_word[2][(word >> 40) & 0xff] ^
              table_word[1][(word >> 48) & 0xff] ^
              table_word[0][word >> 56];
    }
    data += n << 3;
    len &= 7;
    while (len) {
        len--;
        crc = table_byte[crc ^ *data++];
    }
    crc >>= 3;
    return crc;
}

static uint8_t multmodp(uint8_t a, uint8_t b) {
    uint8_t prod = 0;
    for (;;) {
        if (a & 1) {
            prod ^= b;
            if (a == 1)
                break;
        }
        a >>= 1;
        b = b & 0x10 ? (b << 1) ^ 0x9 : b << 1;
    }
    prod &= 0x1f;
    return prod;
}

static uint8_t const table_comb[] = {
    0x02, 0x04, 0x10, 0x1a, 0x0c
};

static uint8_t x8nmodp(uintmax_t n) {
    uint8_t xp = 1;
    int k = 3;
    for (;;) {
        if (n & 1)
            xp = multmodp(table_comb[k], xp);
        n >>= 1;
        if (n == 0)
            break;
        if (++k == 5)
            k = 0;
    }
    return xp;
}

uint8_t crc5epc_c1g2_comb(uint8_t crc1, uint8_t crc2,
        uintmax_t len2) {
    crc1 ^= 0x9;
    return multmodp(x8nmodp(len2), crc1) ^ crc2;
}
